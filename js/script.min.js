const crud=new Firebase("https://adminoxxoparts.firebaseio.com/Oxxo/Users/");var person={userID:"",name:"",accessToken:"",picture:"",email:""};$("#btn_LogFb").click(function(){FB.login(function(a){"connected"==a.status&&(person.userID=a.authResponse.userID,person.accessToken=a.authResponse.accessToken,FB.api("/me?fields=id,name,email,picture.type(large)",function(b){person.name=b.name,person.email=b.email,person.picture=b.picture.data.url,$.ajax({url:crud+".json",type:"GET",beforeSed:function(){swal({title:"Cargando...",text:"Porfavor espere mientras se realiza la petici\xF3n, favor de no cerrar la pagina.",showCancelButton:!1,showConfirmButton:!1,allowEscapeKey:!1,imageUrl:"../views/bootstrap-3.3.5-dist/loading.gif"})},success:function(c){var e={};if(e=c,null==c)$.ajax({url:crud+".json",type:"POST",data:JSON.stringify({UserID:person.userID,Name:person.name,AccessToken:person.accessToken,Image:person.picture,Email:person.email,Privilege:0,Status:0}),success:function(){swal("Registro exitoso "+person.name+".","Su usuario por el momento se encuentra inhabilitado, favor de comunicarse con el Ing. Alexis Luna o a la brevedad se comunicara con usted.","success")}});else{let f;$.each(e,function(g,h){h.UserID===person.userID&&(f=1,1===h.Status?(localStorage.setItem("Name",person.name),localStorage.setItem("Priv",h.Privilege),localStorage.setItem("Image",person.picture),localStorage.setItem("Email",person.email),localStorage.setItem("TokenAccess",g),1==h.Privilege?location.href="Parts/":2==h.Privilege&&(location.href="Generate-Requisitions/")):swal("Usuario inhabilitado "+person.name+"","Su usuario no ha sido autorizado, favor de comunicarse con el Ing. Alexis Luna.","warning"))}),(null===f||void 0===f||""===f)&&$.ajax({url:crud+".json",type:"POST",data:JSON.stringify({UserID:person.userID,Name:person.name,AccessToken:person.accessToken,Image:person.picture,Email:person.email,Privilege:0,Status:0}),success:function(){swal("Registro exitoso "+person.name+".","Su usuario por el momento se encuentra inhabilitado, favor de comunicarse con el Ing. Alexis Luna o a la brevedad se comunicara con usted.","success")}})}}})}))},{scope:"public_profile, email"})}),window.fbAsyncInit=function(){FB.init({appId:"471693236538475",autoLogAppEvents:!0,xfbml:!0,version:"v2.12"})},function(a,b,c){var e,f=a.getElementsByTagName(b)[0];a.getElementById(c)||(e=a.createElement(b),e.id=c,e.src="https://connect.facebook.net/es_ES/sdk.js#xfbml=1&version=v2.12&appId=255513111610034&autoLogAppEvents=1",f.parentNode.insertBefore(e,f))}(document,"script","facebook-jssdk");function onSignIn(a){var b=a.getBasicProfile();$.ajax({url:crud+".json",type:"GET",beforeSed:function(){swal({title:"Cargando...",text:"Porfavor espere mientras se realiza la petici\xF3n, favor de no cerrar la pagina.",showCancelButton:!1,showConfirmButton:!1,allowEscapeKey:!1,imageUrl:"../views/bootstrap-3.3.5-dist/loading.gif"})},success:function(c){var e={};if(e=c,null==c)$.ajax({url:crud+".json",type:"POST",data:JSON.stringify({UserID:b.getId(),Name:b.getName(),AccessToken:a.getAuthResponse().id_token,Image:b.getImageUrl(),Email:b.getEmail(),Privilege:0,Status:0}),success:function(){swal("Registro exitoso "+b.getName()+".","Su usuario por el momento se encuentra inhabilitado, favor de comunicarse con el Ing. Alexis Luna o a la brevedad se comunicara con usted.","success")}});else{let f;$.each(e,function(g,h){h.UserID===b.getId()&&(f=1,1===h.Status?(localStorage.setItem("Name",b.getName()),localStorage.setItem("Priv",h.Privilege),localStorage.setItem("Image",b.getImageUrl()),localStorage.setItem("Email",b.getEmail()),localStorage.setItem("TokenAccess",g),1==h.Privilege?location.href="Parts/":2==h.Privilege&&(location.href="Generate-Requisitions/")):swal("Usuario inhabilitado "+b.getName()+"","Su usuario no ha sido autorizado, favor de comunicarse con el Ing. Alexis Luna.","warning"))}),(null===f||void 0===f||""===f)&&$.ajax({url:crud+".json",type:"POST",data:JSON.stringify({UserID:b.getId(),Name:b.getName(),AccessToken:a.getAuthResponse().id_token,Image:b.getImageUrl(),Email:b.getEmail(),Privilege:0,Status:0}),success:function(){swal("Registro exitoso "+b.getName()+".","Su usuario por el momento se encuentra inhabilitado, favor de comunicarse con el Ing. Alexis Luna o a la brevedad se comunicara con usted.","success")}})}}})}function signOut(){var a=gapi.auth2.getAuthInstance();a.signOut().then(function(){$(".g-signin2").show()})}