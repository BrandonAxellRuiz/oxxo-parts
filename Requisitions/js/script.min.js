const crud=new Firebase("https://adminoxxoparts.firebaseio.com/Oxxo/Requisitions/"),imgUser=localStorage.getItem("Image"),nameUser=localStorage.getItem("Name"),privUSer=localStorage.getItem("Priv"),emailUser=localStorage.getItem("Email"),Token=localStorage.getItem("TokenAccess"),date=new Date,d=document,c=console.log,btn_car_send=d.getElementById("btn_car_send");var storageService=firebase.storage();window.onload=function(){1==privUSer?$(".user").hide():2==privUSer?$(".admin").hide():(window.localStorage.clear(),location.href="../"),$("#imgUser").attr("src",imgUser),$("#nameUser").html(nameUser),$("#emailUser").html(emailUser)},crud.on("child_added",function(a){$("#tabla").append(carga(a.key(),a.val()))}),crud.on("child_removed",function(a){$("."+a.key()).hide(2e3)}),crud.on("child_changed",function(a){a.val()});function carga(){var a={};crud.on("value",function(b){var e="";a=b.val();var f="";let i=0;$.each(a,function(j,k){i++,mydate=new Date(k.Date_S);let l={weekday:"long",year:"numeric",month:"long",day:"numeric"};if(1==privUSer){e+="<thead class=\""+j+"\">",e+="<tr>",e+="<th>Estatus</th>",e+="<th>Nombre de Usuario</th>",e+="<th>Fecha</th>",e+="<th>Abrir Requisicion</th>",e+="</tr>",e+="</thead>",e+="<tbody class=\""+j+"\">",e+="<tr>";var m="'"+j+"'";1===k.Status?status="<span class=\"label bg-green\">Aprobada</span>":2===k.Status?status="<span class=\"label bg-orange\">Nuevo</span>":3===k.Status?status="<span class=\"label bg-black\">Rechazada</span>":4===k.Status&&(status="<span class=\"label bg-red\">Incompleta</span>"),f="<a class=\"btn btn-info\" onclick=\"open_requisition("+m+")\" id=\"btn_"+j+"\" style=\"cursor:pointer !important;\"><i class=\"material-icons\">open_in_new</i></b>",e+="<td style=\"font-size:18px;\">"+status+"</td>",e+="<td><p id=\"Users"+k.Users+"\">"+k.nameUser+"</p></td>",e+="<td><b>"+mydate.toLocaleDateString("es-MX",l)+"</b></td>",e+="<td>"+f+"</td>",e+="</tr>",e+="</tbody>"}else if(Token===k.Users){e+="<thead class=\""+j+"\">",e+="<tr>",e+="<th>Estatus</th>",e+="<th>Nombre de Usuario</th>",e+="<th>Fecha</th>",e+="<th>Abrir Requisicion</th>",e+="</tr>",e+="</thead>",e+="<tbody class=\""+j+"\">",e+="<tr>";var m="'"+j+"'";1===k.Status?status="<span class=\"label bg-green\">Aprobada</span>":2===k.Status?status="<span class=\"label bg-orange\">Nuevo</span>":3===k.Status?status="<span class=\"label bg-black\">Rechazada</span>":4===k.Status&&(status="<span class=\"label bg-red\">Incompleta</span>"),f="<a class=\"btn btn-info\" onclick=\"open_requisition("+m+")\" id=\"btn_"+j+"\" style=\"cursor:pointer !important;\"><i class=\"material-icons\">open_in_new</i></b>",e+="<td style=\"font-size:18px;\">"+status+"</td>",e+="<td><p id=\"Users"+k.Users+"\">"+k.nameUser+"</p></td>",e+="<td><b>"+mydate.toLocaleDateString("es-MX",l)+"</b></td>",e+="<td>"+f+"</td>",e+="</tr>",e+="</tbody>"}}),$("#tabla").html(e),$(".lazy").lazy(),$(".c_noti").html(i)})}function open_requisition(a){localStorage.setItem("open_requisition",a),location.href="../Open-Requisition/"}